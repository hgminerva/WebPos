
@{
    ViewBag.Title = "AddDiscount";
}
<!-- ADD THE CLASS sidedar-collapse TO HIDE THE SIDEBAR PRIOR TO LOADING THE SITE -->
<body class="hold-transition skin-blue sidebar-collapse sidebar-mini">
    <!-- Site wrapper -->
    <div class="wrapper">

        <!-- ===================Main Header============================ -->
        @Html.Partial("_MainHeader")
        <!-- ===================Main Sidebar============================ -->
        @Html.Partial("_MainSidebar")
        <!-- =============================================== -->

        <div class="content-wrapper">
            <!-- Content Header (Page header) -->
            <section class="content-header">
                <h1 class="fa fa-percent">
                    Discount Detail
                </h1>
                <ol class="breadcrumb">
                    <li><a href="../Software/Dashboard"><i class="fa fa-table"></i> Home</a></li>
                    <li><a href="../Software/Discount">Discount</a></li>
                    <li class="active">Add Discount</li>
                </ol>
                <!---Menu Tab-->
                <div class="container">
                    <div class="row">
                        <div class="col-md-12">

                            <!-- Nav tabs -->
                            <div class="card">
                                <section class="container">
                                    <!--Buttons-->
                                    <div class="btn-group-horizontal pull-right">
                                        <a class="btn btn-app">
                                            <i class="fa fa-lock" onclick="test()"></i> Lock
                                        </a>
                                        <a class="btn  btn-app">
                                            <i class="fa fa-unlock"></i> Unlock
                                        </a>
                                        <a class="btn btn-app">
                                            <i class="fa fa-close"></i> Close
                                        </a>
                                    </div><!--btn horizontal-->
                                </section>
                            </div>
                        </div>
                    </div>
                    <div class="box box-primary">
                        <!-- form start -->
                        <form class="form-horizontal">
                            <div class="box-body">

                                <div class="form-group">
                                    <label for="discount" class="col-sm-2 control-label">Discount</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control" id="discount" placeholder="NA">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="discountRate" class="col-sm-2 control-label">Discount Rate</label>
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control" id="discountRate" placeholder="NA">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label">VAT Exempt</label>
                                    <div class="col-sm-6">
                                        <input type="checkbox" class="minimal" checked>
                                    </div>
                                </div>
                                <div class="box-body table-responsive no-padding">
                                    <table class="table table-bordered" style="background-color:#3c8dbc">
                                        <tr>
                                            <th>Date Schedule</th>
                                            <th><input type="checkbox" class="minimal" checked></th>
                                            <th><label class="">Day Scheduled</label></th>
                                            <th colspan="7"><input type="checkbox" class="minimal" checked></th>
                                            <th><label>Time Scheduled</label></th>
                                            <th><input type="checkbox" class="minimal" checked></th>
                                        </tr>
                                        <tr>
                                            <th>Date Start</th>
                                            <th><input type="date" id="strdate" placeholder=""></th>
                                            <th rowspan="2">Day</th>
                                            <th><label>Mon</label></th>
                                            <th><label>Tue</label></th>
                                            <th><label>Wed</label></th>
                                            <th><label>Thu</label></th>
                                            <th><label>Fri</label></th>
                                            <th><label>Sat</label></th>
                                            <th><label>Sun</label></th>
                                            <th><label>Time Start</label></th>
                                            <th><input type="time" id="srttime" placeholder=""></th>
                                        </tr>
                                        <tr>
                                            <th>Date End</th>
                                            <th><input type="date" id="endate" placeholder=""></th>
                                            <th><input type="checkbox" class="minimal" checked></th>
                                            <th><input type="checkbox" class="minimal" checked></th>
                                            <th><input type="checkbox" class="minimal" checked></th>
                                            <th><input type="checkbox" class="minimal" checked></th>
                                            <th><input type="checkbox" class="minimal" checked></th>
                                            <th><input type="checkbox" class="minimal" checked></th>
                                            <th><input type="checkbox" class="minimal" checked></th>
                                            <th><label>Time end</label></th>
                                            <th><input type="time" id="endtime" placeholder=""></th>
                                        </tr>
                                    </table>
                                    <div class="box-body table-responsive no-padding">
                                        <!--table-->
                                        <div id="tableDiscount" class="grid border-custom" style="height:300px"></div>
                                        <!--/.table-->
                                </div><!-- /.box-body -->

                            </div><!-- /.box-body -->
                            <div class="box-footer">
                            </div><!-- /.box-footer -->
                        </form>
                    </div><!-- /.box -->
                </div>

            </section>
        </div><!-- ./wrapper -->
        <!-- ===================Main Footer============================ -->
        @Html.Partial("_MainFooter")
    </div>
    <script type="text/javascript">
        //================
        // Global variables
        // ================
        var discountCollections;
        var discountRow;
        var discountColumns;

        var combobox = 'Korea, Germany, US, UK'.split(',');

        function loadItems() {
            $.ajax({
                url: '/api/item/list',
                type: 'GET',
                contentType: "application/json;charset=utf-8",
                cache: false,
                success: function (result, status, xhr) {
                    updateItems(result);
                },
            });
        }

        function updateItems(data) {
            var items = [];
            if (data != null || data != undefined) {
                $.each(data, function (index, value) {
                    items[index] = data[index]["ItemDescription"];
                });
            }
        }

        function init() {
            discountColumns = new wijmo.collections.ObservableArray();
            discountCollections = new wijmo.collections.CollectionView(discountColumns);
            discountRow = new wijmo.grid.FlexGrid('#tableDiscount');

            //Flex grid
            discountRow.initialize({
                columns: [

                {
                    "header": "Delete",
                    "binding": "DeleteId",
                    "width": 70,
                    "align": "center",
                    "isContentHtml": true,
                    "isReadOnly": true,
                    "allowSorting": false
                },
                {
                    "header": "Item",
                    "binding": "ItemId",
                    "width": 500,
                    "align": "center",
                    "dataMap": combobox,
                    "isContentHtml": true,
                    "dataType": "String"
                },
                {
                    "header": "A",
                    "binding": "AId",
                    "width": 50,
                    "align": "center",
                    "isContentHtml": true,
                    "dataType": "Boolean"
                },
                {
                    "header": " ",
                    "binding": "EmptyId",
                    "align": "center",
                    "allowSorting": false,
                    "width": "2*",
                    "isReadOnly": true
                }],
                autoGenerateColumns: false,
                itemsSource: discountCollections,
                autoSizeMode: wijmo.grid.AutoSizeMode.Both,
                allowDragging: wijmo.grid.AllowDragging.None,
                selectionMode: wijmo.grid.SelectionMode.Row,
                cellFormatter: function (args) {

                }
            });
        }

        function addRow() {
            discountColumns.push({
                DeleteId: "<button class='btn btn-danger btn-xs btn-block' id='itemDeleteButton'><i class='fa fa-trash'></i>Delete</button>",
                AId:false,
                EmptyId: ""
            });
        }

        // =====================
        // Item delete Button
        // =====================
        function cmdItemDeleteButton_OnClick() {
            var id = itemCollections.currentItem.Id;

            console.log(typeof id + id);

            $('#deleteItemConfirm').modal({
                show: true,
                backdrop: 'static'
            });
            $("#cmdConfirmDeleteItem").prop("disabled", false);
            $("#cmdConfirmDeleteCloseButton").prop("disabled", false);
        }
        // Company Confirm Delete Button
        function cmdItemConfirmDeleteButton_OnClick() {
            $("#cmdConfirmDeleteItem").prop("disabled", true);
            $("#cmdConfirmDeleteCloseButton").prop("disabled", true);

            //====================
            var id = itemCollections.currentItem.Id;

            $.ajax({
                url: '/api/item/delete/' + id,
                type: "DELETE",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                statusCode: {
                    200: function () {
                        $("#cmdConfirmDeleteItem").prop("disabled", true);
                        $("#cmdConfirmDeleteCloseButton").prop("disabled", true);
                        toastr.success("Successfully Deleted");
                        window.setTimeout(function () {
                            location.reload()
                        }, 1000);
                    },
                    404: function () {
                        toastr.error("Request Not Found");
                        $('#deleteItemConfirm').modal('hide');
                        $("#cmdConfirmDeleteItem").prop("disabled", false);
                        $("#cmdConfirmDeleteCloseButton").prop("disabled", false);
                    },
                    400: function () {
                        toastr.error("Can't be deleted");
                        $('#deleteItemConfirm').modal('hide');
                        $("#cmdConfirmDeleteItem").prop("disabled", false);
                        $("#cmdConfirmDeleteCloseButton").prop("disabled", false);
                    }
                }
            });
        }

        //============
        // On Page Load
        // ============
        $(document).ready(function () {
            loadItems();
            init();
            addRow();
        });
    </script>
</body>




